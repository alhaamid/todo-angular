<div class="mainContainer">
  <div class="dashboard">

    <div class="addNoteSection">
      
      <h2>Add Note</h2>
      <button *ngIf="!showNewNote" mat-icon-button (click)="toggleNewNoteState()" title="Show New Note">
        <mat-icon class="material-icons">expand_more</mat-icon>
      </button>
      <button *ngIf="showNewNote" mat-icon-button (click)="toggleNewNoteState()" title="Show New Note">
        <mat-icon class="material-icons">expand_less</mat-icon>
      </button>

      <div *ngIf="showNewNote" class="newNoteForm" @fade>
        <form [formGroup]="rForm">
          
          <div class="validationError" *ngIf="!rForm.controls['titleValidation'].valid && rForm.controls['titleValidation'].touched">
            Title is required.
          </div>

          <div class="table">
            <div class="tableInputCell tableCell">
              <mat-form-field><input matInput formControlName="titleValidation" [(ngModel)]="this.newNote.title" name="title" placeholder="{{this.titlePlaceholder}}"></mat-form-field>
            </div>
            <div class="tableRestCell tableCell"></div>
          </div>

          <div class="taskRow" *ngFor="let newToDo of this.newNote.content.toDos; index as i">
            <mat-checkbox class="tableCell" [(ngModel)]="newToDo.done" [ngModelOptions]="{standalone: true}" name="done" title="Done?"></mat-checkbox>
            <div class="tableInputCell tableCell">
              <mat-form-field><input matInput [(ngModel)]="newToDo.task" [ngModelOptions]="{standalone: true}" name="task" placeholder="{{this.taskPlaceholder}}"></mat-form-field>
            </div>
            <div class="tableRestCell tableCell">
              <button mat-icon-button (click)="ns.addToDo(this.newNote, i+1, false)" title="Add task"><mat-icon class="material-icons">add_circle_outline</mat-icon></button>
              <button *ngIf="this.newNote.content.toDos.length>1" mat-icon-button (click)="ns.deleteToDo(this.newNote, i, false)" title="Remove task"><mat-icon class="material-icons">highlight_off</mat-icon></button>
            </div>
            
          </div>

          <!-- <br><button mat-raised-button type='submit' color="primary" [disabled]="!this.rForm.valid" (click)="addNote()">Add this note</button> -->
          <button mat-icon-button color="primary" type='submit' [disabled]="!rForm.valid" (click)="addNote()" title="Save"><mat-icon class="material-icons">save</mat-icon></button>
        </form>
      </div>

    </div>

    <div *ngIf="this.allNotes" class="yourNotesSection">
      <h2>Your Notes</h2>

      <div class="aNoteContainer" *ngFor="let note of this.allNotes; index as noteIndex">
        
        <div *ngIf="!editDictionary[note.noteId]">
          <mat-card>
            <mat-card-header><h2>{{note.title}}</h2></mat-card-header>
            
            <mat-card-content>
              <div class="cardDetailTaskRow" *ngFor="let todo of note.content.toDos; index as toDoIndex;">
                <mat-checkbox class="tableCell" [(ngModel)]="todo.done" name="todo.done" (change)="ns.setNote(note);" title="Done?"></mat-checkbox>
                <h4 class="tableCell">{{todo.task}}</h4>
              </div>
            </mat-card-content>

            <mat-card-actions>
              <button mat-icon-button color="primary" (click)="toggleEditState(note.noteId)" title="Edit"><mat-icon class="material-icons">edit</mat-icon></button>
              <button mat-icon-button color="warn" (click)="ns.deleteNote(note)" title="Delete"><mat-icon class="material-icons">delete</mat-icon></button>
            </mat-card-actions>
          </mat-card>
        </div>

        <div *ngIf="editDictionary[note.noteId]">
          <form [formGroup]="formDictionary[note.noteId]">
            <div class="validationError" *ngIf="!formDictionary[note.noteId].controls['titleValidation'].valid && formDictionary[note.noteId].controls['titleValidation'].touched">
              Title is required.
            </div>
  
            <div class="table">
              <div class="tableInputCell tableCell">
                <mat-form-field>
                  <input matInput formControlName="titleValidation" [(ngModel)]="note.title" name="title" placeholder="{{this.titlePlaceholder}}">
                </mat-form-field>
              </div>
              <div class="tableRestCell tableCell"></div>
            </div>

            <div class="taskRow" *ngFor="let todo of note.content.toDos; index as toDoIndex;">
              
              <mat-checkbox class="tableCell" [(ngModel)]="todo.done" [ngModelOptions]="{standalone: true}" name="todo.done" title="Done?"></mat-checkbox>
              <div class="tableInputCell tableCell">
                <mat-form-field><input matInput [(ngModel)]="todo.task" [ngModelOptions]="{standalone: true}" name="todo.task" placeholder="{{this.taskPlaceholder}}"></mat-form-field>
              </div>
              <div class="tableRestCell tableCell">
                <button mat-icon-button (click)="ns.addToDo(note, toDoIndex+1, true)" title="Add task"><mat-icon class="material-icons">add_circle_outline</mat-icon></button>
                <button *ngIf="note.content.toDos.length>1"  mat-icon-button (click)="ns.deleteToDo(note, toDoIndex, true)" title="Remove task"><mat-icon class="material-icons">highlight_off</mat-icon></button>
              </div>

            </div>
  
            <button mat-icon-button color="primary" [disabled]="!formDictionary[note.noteId].valid" (click)="toggleEditState(note.noteId); ns.setNote(note);" title="Save"><mat-icon class="material-icons">save</mat-icon></button>

          </form>
        </div>

      </div>
    </div>

  </div>
</div>











<!-- <button mat-icon-button (click)="toggleEditState(note.noteId)" title="Done"><mat-icon class="material-icons">edit</mat-icon></button>
<h3>{{note.title}}</h3>
<div class="taskRow" *ngFor="let todo of note.content.toDos; index as toDoIndex;">
  <h4>{{todo.task}}</h4>
  <mat-checkbox [(ngModel)]="todo.done" name="todo.done" (change)="ns.setNote(note);" title="Done?"></mat-checkbox>
</div> -->


<!-- <div class="taskRow" *ngFor="let newToDo of note.content.toDos; index as i">
  <mat-form-field><input matInput [(ngModel)]="newToDo.task" [ngModelOptions]="{standalone: true}" name="task" placeholder="{{this.taskPlaceholder}}"></mat-form-field>
  <mat-checkbox [(ngModel)]="newToDo.done" [ngModelOptions]="{standalone: true}" name="done" title="Done?"></mat-checkbox>
  <button mat-icon-button (click)="ns.addToDo(this.newNote, i+1, false)" title="Add task"><mat-icon class="material-icons">add_circle_outline</mat-icon></button>
  <button *ngIf="this.newNote.content.toDos.length>1" mat-icon-button (click)="ns.deleteToDo(this.newNote, i, false)" title="Remove task"><mat-icon class="material-icons">highlight_off</mat-icon></button>
</div> -->

<!-- <button *ngIf="rForm.controls['titleValidation'].valid" mat-icon-button type='submit' color="primary" [disabled]="!this.rForm.valid" (click)="addNote()">
  <mat-icon class="material-icons">note_add</mat-icon>
</button> -->


<!-- <div class="container addNoteSection">
  <h2>Add a Note</h2>
  <form [formGroup]="rForm">
    <div>
      <input type="text" formControlName="titleValidation" [(ngModel)]="this.newNote.title" name="title" placeholder="{{this.titlePlaceholder}}">

      <div *ngIf="!rForm.controls['titleValidation'].valid && rForm.controls['titleValidation'].touched">
        Title is required.
      </div>
    </div>

    <div class="content">
      <div *ngFor="let newToDo of this.newNote.content.toDos; index as i">

        <input type="checkbox" [(ngModel)]="newToDo.done" [ngModelOptions]="{standalone: true}" name="done">
        <input type="text" [(ngModel)]="newToDo.task" [ngModelOptions]="{standalone: true}" name="task" placeholder="{{this.taskPlaceholder}}">
        <span class="glyphicon glyphicon-plus" (click)="ns.addToDo(this.newNote, i+1, false)"></span>
        <span class="glyphicon glyphicon-trash" (click)="ns.deleteToDo(this.newNote, i, false)"></span>

      </div>
    </div>

    <input type="submit" value="Add this note" [disabled]="!this.rForm.valid" (click)="addNote()">

  </form>
</div>

<div *ngIf="this.allNotes">
  <div class="container yourNotesSection">
    <h2>Your Notes</h2>
    <div *ngFor="let note of this.allNotes; index as noteIndex ">
      <div class="content">
        <h3> {{ note.title }} </h3>
        <div *ngFor="let todo of note.content.toDos; index as toDoIndex;">
          <div>
          
            <input type="checkbox" [(ngModel)]="todo.done" name="todo.done" (change)="ns.setNote(note);">
            <input type="text" [(ngModel)]="todo.task" name="todo.task" (change)="ns.setNote(note)"  placeholder="{{this.taskPlaceholder}}">
            <span class="glyphicon glyphicon-plus" (click)="ns.addToDo(note, toDoIndex+1, true)"></span>
            <span class="glyphicon glyphicon-trash" (click)="ns.deleteToDo(note, toDoIndex, true)"></span>
          
          </div>
        </div>
        <button (click)="ns.deleteNote(note)">Delete</button>
      </div>
    </div>
  </div>
</div> -->





























<!-- old input note section with no validation -->
<!-- <div class="addNoteSection">
  <h2>Add a Note</h2>
  <div class="noteForm">

    <input type="text" [(ngModel)]="this.newNote.title" name="title" placeholder="{{this.titlePlaceholder}}"><br>

    <div class="content">
      <div *ngFor="let newToDo of this.newNote.content.toDos; index as i">

        <input type="checkbox" [(ngModel)]="newToDo.done" name="done">
        <input type="text" [(ngModel)]="newToDo.task" name="task" placeholder="{{this.taskPlaceholder}}">
        <span class="glyphicon glyphicon-plus" (click)="ns.addToDo(this.newNote, i+1, false)"></span>
        <span class="glyphicon glyphicon-trash" (click)="ns.deleteToDo(this.newNote, i, false)"></span>

      </div>
    </div>

    <input type="submit" value="Add this note" (click)="ns.addNote(this.newNote)">

  </div>
</div> -->


<!-- <div class="addNoteSection">
  <h2>Add a Note</h2>
  <form [formGroup]="rForm">
    <div>
      <label>Title
        <input type="text" formControlName="title">
      </label>
      <div *ngIf="!rForm.controls['title'].valid && rForm.controls['title'].touched">
          Title is required.
        </div>
    </div>

    <input type="submit" value="Add this note" (click)="addPost()">

  </form>
</div> -->